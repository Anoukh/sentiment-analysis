import java.io.*;
import java.util.ArrayList;
import java.util.Scanner;
import java.util.regex.Matcher;
import java.util.regex.Pattern;

/**
 * Created by chehara on 7/5/16.
 */

//Common : Negative-Positive

public class NegativePositive {
    static FileWriter writer;
    private static String Option = "COMMON";
    private String[] positiveWordBucket;
    private String[] negativeWordBucket;

    public static void main(String[] args) throws Exception {
        writer = new FileWriter("/home/chehara/Videos/100K/sentiment/CommonSet100K.csv");
        NegativePositive tt=new NegativePositive();
        try {
            tt.negativeWordBucket = tt.getWordsBuckets("negativewords.txt");
            System.out.println(tt.negativeWordBucket[7]);
        } catch (IOException e) {
            System.out.println("Failed to load  negativewords.txt  file ");
        }
        try {
            tt.positiveWordBucket = tt.getWordsBuckets("positivewords.txt");
            System.out.println(tt.positiveWordBucket[7]);
        } catch (IOException e) {
            System.out.println("Failed to load positivewords.txt  file ");
        }

        BufferedReader crunchifyBuffer = null;
        String crunchifyLine;
        crunchifyBuffer = new BufferedReader(new FileReader("/home/chehara/Videos/100K/Thunen1.csv"));

        int count=0;
        while ((crunchifyLine = crunchifyBuffer.readLine()) != null) {
//            System.out.println(tt.getCommonSentimentRate(crunchifyLine));
            writer.write(Integer.toString(tt.getCommonSentimentRate(crunchifyLine)));
            writer.append('\n');
        }
        writer.flush();
    }

    public int getCommonSentimentRate(String contentText) {
        int positiveRank = 0;
        for (int i = 0; i < positiveWordBucket.length; i++) {
            Matcher m = Pattern.compile("\\b" + positiveWordBucket[i] + "\\b").matcher(contentText);
            while (m.find()) {
                positiveRank++;
            }
        }
        int negativeRank = 0;
        for (int i = 0; i < negativeWordBucket.length; i++) {
            Matcher m = Pattern.compile("\\b" + negativeWordBucket[i] + "\\b").matcher(contentText);
            while (m.find()) {
                negativeRank++;
            }
        }
        return positiveRank - negativeRank;

    }
    public String[] getWordsBuckets(String fileName) throws IOException {
        String[] wordList = null;
        StringBuilder textChunk = new StringBuilder();
        ClassLoader classLoader = getClass().getClassLoader();
        File file = new File(classLoader.getResource(fileName).getFile());
        try {
            Scanner scanner = new Scanner(file);
            while (scanner.hasNextLine()) {
                String line = scanner.nextLine();
                textChunk.append(line).append("\n");
            }
            scanner.close();
        } catch (IOException e) {
            System.out.println("Error reading "+fileName+" File");
        }
        wordList = textChunk.toString().split(",");
        return wordList;
    }

    public static ArrayList<String> CSVtoArrayList(String text) {
        ArrayList<String> result = new ArrayList<String>();
        if (text != null) {
            result.add(text);
        }
        return result;
    }
}
